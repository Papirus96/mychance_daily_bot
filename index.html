
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–ê–ù–° ‚Äî –í—Å–µ –∫–æ–Ω–∫—É—Ä—Å—ã (VIP)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #ffcc66;
            color: #7a2e14;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
            font-size: 28px;
            color: #a64214;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: #fff8e1;
        }
        th, td {
            border: 1px solid #e0a958;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #ffd27f;
        }
        a {
            color: #a64214;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            font-size: 14px;
            color: #9c4f20;
        }
    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['table']});
        google.charts.setOnLoadCallback(drawTable);

        function drawTable() {
            const queryString = encodeURIComponent("SELECT A, B, C, D, E WHERE A IS NOT NULL");
            const url = 'https://docs.google.com/spreadsheets/d/1ywWbGtsvKfrYdxFsekvXL7EKmd30_xxZQB0E8XqUU8U/gviz/tq?sheet=–ö–æ–Ω–∫—É—Ä—Å—ã%20–®–ê–ù–°&range=A:E&tq=' + queryString;

            fetch(url)
                .then(res => res.text())
                .then(rep => {
                    const json = JSON.parse(rep.substr(47).slice(0, -2));
                    const table = document.createElement("table");
                    const thead = document.createElement("thead");
                    thead.innerHTML = `<tr>
                        <th>–ö–∞–Ω–∞–ª</th>
                        <th>–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à</th>
                        <th>–ü—Ä–∏–∑—ã</th>
                        <th>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</th>
                        <th>–£—Å–ª–æ–≤–∏—è</th>
                    </tr>`;
                    table.appendChild(thead);

                    const tbody = document.createElement("tbody");
                    json.table.rows.forEach(row => {
                        const cells = row.c.map(cell => (cell && cell.v) || "");
                        const tr = document.createElement("tr");

                        // –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª
                        const channelTd = document.createElement("td");
                        const channelLink = document.createElement("a");
                        channelLink.href = cells[0];
                        channelLink.textContent = new URL(cells[0]).hostname.replace("t.me/", "");
                        channelLink.target = "_blank";
                        channelTd.appendChild(channelLink);
                        tr.appendChild(channelTd);

                        // –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à
                        const drawTd = document.createElement("td");
                        const drawLink = document.createElement("a");
                        drawLink.href = cells[1];
                        drawLink.textContent = "–û—Ç–∫—Ä—ã—Ç—å";
                        drawLink.target = "_blank";
                        drawTd.appendChild(drawLink);
                        tr.appendChild(drawTd);

                        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
                        for (let i = 2; i < cells.length; i++) {
                            const td = document.createElement("td");
                            td.textContent = cells[i];
                            tr.appendChild(td);
                        }

                        tbody.appendChild(tr);
                    });
                    table.appendChild(tbody);
                    document.getElementById("table-container").appendChild(table);
                });
        }
    </script>
</head>
<body>
    <h1>üéÅ –í—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω–∫—É—Ä—Å—ã (VIP)</h1>
    <div id="table-container"></div>
    <div class="footer">–î–∞–Ω–Ω—ã–µ –∏–∑ Google –¢–∞–±–ª–∏—Ü—ã ‚Ä¢ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
</body>
</html>
